<% if (title) { %>
<h1><%= title %></h1>
<% } else { res.redirect('/') } %>
<!-- Messages -->
<%- messages() %>
<!-- Errors -->
<% if (errors != null) { %>
<ul class="notice">
  <% errors.array().forEach(error => { %> <% if (error.msg
  != 'Invalid value') { %>

  <li><%= error.msg %></li>
  <% }}) %>
</ul>
<% } %>
<form
  id="addVehicleForm"
  action="/inv/add-vehicle"
  method="post">
  <label for="classification_id">Classification</label>
  <select
    title="Classification"
    id="classification_id"
    name="classification_id"
    required>
    <option value="">Select a classification</option>
    <%- classificationOptions %>
  </select>
  <label for="inv_make">Make</label>
  <input
    type="text"
    id="inv_make"
    name="inv_make"
    placeholder="Make"
    value="<%= locals.inv_make %>"
    required />
  <label for="inv_model">Model</label>
  <input
    type="text"
    id="inv_model"
    name="inv_model"
    placeholder="Model"
    value="<%= locals.inv_model %>"
    required />
  <label for="inv_year">Year</label>
  <input
    type="number"
    id="inv_year"
    name="inv_year"
    placeholder="Year"
    value="<%= locals.inv_year %>"
    required />
  <label for="inv_color">Color</label>
  <input
    type="text"
    id="inv_color"
    name="inv_color"
    placeholder="Color"
    value="<%= locals.inv_color %>"
    required />
  <label for="inv_miles">Mileage</label>
  <input
    type="number"
    id="inv_miles"
    name="inv_miles"
    placeholder="Mileage"
    value="<%= locals.inv_miles %>"
    required />
  <label for="inv_price">Price</label>
  <input
    type="number"
    id="inv_price"
    name="inv_price"
    placeholder="Price"
    value="<%= locals.inv_price %>"
    required />
  <label for="inv_description">Description</label>
  <textarea
    id="inv_description"
    name="inv_description"
    placeholder="Description"
    required>
<%= locals.inv_description %>
  </textarea>
  <label for="inv_image">Image Path</label>
  <input
    type="text"
    id="inv_image"
    name="inv_image"
    placeholder="Image Path"
    value="<%= locals.inv_image %>"
    required />
  <label for="inv_thumbnail">Thumbnail Path</label>
  <input
    type="text"
    id="inv_thumbnail"
    name="inv_thumbnail"
    placeholder="Thumbnail Path"
    value="<%= locals.inv_thumbnail %>"
    required />
  <button type="submit">Add Vehicle</button>
</form>
<script>
  const select = document.getElementById(
    "classification_id"
  );

  window.addEventListener("DOMContentLoaded", () => {
    const savedValue = localStorage.getItem(
      "classification_id"
    );
    if (savedValue) select.value = savedValue;
    else {
      select.value = "";
    }
  });

  select.addEventListener("change", () => {
    localStorage.setItem("classification_id", select.value);
  });
</script>
